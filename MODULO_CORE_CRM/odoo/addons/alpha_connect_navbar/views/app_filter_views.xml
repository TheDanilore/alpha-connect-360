<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Personalizar la vista de aplicaciones para ocultar Enterprise -->
    <record id="module_form_alpha_filter" model="ir.ui.view">
        <field name="name">module.form.alpha.filter</field>
        <field name="model">ir.module.module</field>
        <field name="inherit_id" ref="base.module_form"/>
        <field name="arch" type="xml">
            <!-- Ocultar el campo to_buy y botones relacionados -->
            <xpath expr="//field[@name='to_buy']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            
            <!-- Ocultar botones de upgrade si existen -->
            <xpath expr="//button[@name='button_immediate_upgrade']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            
            <xpath expr="//button[@name='button_upgrade']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>
    
    <!-- Personalizar la vista tree de módulos -->
    <record id="module_tree_alpha_filter" model="ir.ui.view">
        <field name="name">module.tree.alpha.filter</field>
        <field name="model">ir.module.module</field>
        <field name="inherit_id" ref="base.module_tree"/>
        <field name="arch" type="xml">
            <!-- Ocultar campo to_buy en la vista lista -->
            <xpath expr="//field[@name='to_buy']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
        </field>
    </record>
    
    <!-- Personalizar la vista kanban de aplicaciones -->
    <record id="module_kanban_alpha_filter" model="ir.ui.view">
        <field name="name">module.kanban.alpha.filter</field>
        <field name="model">ir.module.module</field>
        <field name="inherit_id" ref="base.module_kanban_view"/>
        <field name="arch" type="xml">
            <!-- Filtrar aplicaciones Enterprise en la vista kanban -->
            <xpath expr="//kanban" position="attributes">
                <attribute name="domain">[('to_buy', '=', False)]</attribute>
            </xpath>
            
            <!-- Ocultar elementos relacionados con Enterprise -->
            <xpath expr="//field[@name='to_buy']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            
            <!-- Personalizar el template del kanban -->
            <xpath expr="//div[hasclass('oe_module_vignette')]" position="attributes">
                <attribute name="t-if">!record.to_buy.raw_value</attribute>
            </xpath>
        </field>
    </record>
    
    <!-- Acción personalizada para aplicaciones sin Enterprise -->
    <record id="open_module_tree_alpha" model="ir.actions.act_window">
        <field name="name">Apps (Alpha Connect 360)</field>
        <field name="res_model">ir.module.module</field>
        <field name="view_mode">kanban,tree,form</field>
        <field name="view_id" ref="module_kanban_alpha_filter"/>
        <field name="search_view_id" ref="base.view_module_filter"/>
        <field name="domain">[('to_buy', '=', False), ('application', '=', True)]</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                No applications found!
            </p>
            <p>
                Alpha Connect 360 shows only available applications.
            </p>
        </field>
    </record>
    
    <!-- Menú personalizado para aplicaciones -->
    <menuitem 
        id="menu_alpha_apps" 
        name="Apps" 
        action="open_module_tree_alpha" 
        parent="base.menu_management" 
        sequence="1"/>

</odoo>
